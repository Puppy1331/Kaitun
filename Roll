-- âš™ï¸ Cáº¥u hÃ¬nh
local RollBee = true      -- Roll há»™p bee?
local RollSun = false     -- Roll há»™p sun?
local SeedWaitRoll = 9000
local MaxRollsPerCycle = 2        -- â— Sá»‘ láº§n roll má»—i khi Ä‘á»§ seeds
local DelayBetweenRolls = 1       -- â— Delay giá»¯a má»—i láº§n roll (giÃ¢y)

local _wait = task.wait

repeat _wait() until game:IsLoaded()
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = game:GetService("Players").LocalPlayer
local logicRoot = player:WaitForChild("PlayerGui"):WaitForChild("LogicHolder")
local modulesDir = logicRoot:WaitForChild("ClientLoader"):WaitForChild("Modules")
local ClientDataHandler = require(modulesDir:WaitForChild("ClientDataHandler"))
local deleteRemote = ReplicatedStorage:WaitForChild("RemoteFunctions"):WaitForChild("DeleteUnit")

-- ðŸŒ€ HÃ m roll theo cáº¥u hÃ¬nh vÃ  giá»›i háº¡n
local function Roll()
    for i = 1, MaxRollsPerCycle do
        if RollBee then
            local args_bee = { "ub_bee", 10 }
            ReplicatedStorage.RemoteFunctions.BuyUnitBox:InvokeServer(unpack(args_bee))
        end

        if RollSun then
            local args_sun = { "ub_sun", 10 }
            ReplicatedStorage.RemoteFunctions.BuyUnitBox:InvokeServer(unpack(args_sun))
        end

        task.wait(DelayBetweenRolls) -- â±ï¸ Delay má»—i láº§n roll
    end
end

-- ðŸ§¹ XoÃ¡ unit trÃ¹ng láº·p, giá»¯ láº¡i godly vÃ  Ä‘ang equip
local function RemoveUnit()
    local inventory = ClientDataHandler.GetValue("Inventory")
    local toDelete, kept = {}, {}

    for uniqueId, unitData in pairs(inventory or {}) do
        local itemId = unitData.ItemData and unitData.ItemData.ID
        local rarity = require(player.PlayerGui.LogicHolder.ClientLoader.SharedConfig.ItemData.Units.Configs:FindFirstChild(itemId))
        if rarity.Rarity == "ra_godly" or unitData.Equipped == true then
            kept[itemId] = true
        elseif not kept[itemId] then
            kept[itemId] = true
        else
            table.insert(toDelete, uniqueId)
        end
    end

    if #toDelete > 0 then
        print("ðŸ—‘ï¸ Deleting", #toDelete, "units...")
        pcall(function() deleteRemote:InvokeServer(toDelete) end)
    else
        print("âœ… KhÃ´ng cÃ³ unit nÃ o cáº§n xoÃ¡.")
    end
end

-- ðŸ” VÃ²ng láº·p chÃ­nh
local function ParseNumber(str)
    str = tostring(str):gsub(",", "")
    local multipliers = { k = 1e3, m = 1e6, b = 1e9, t = 1e12 }
    local number, suffix = str:lower():match("([%d%.]+)([kmbt]?)")
    return tonumber(number) * (multipliers[suffix] or 1)
end

while true do
    local Seeds = player.leaderstats.Seeds.Value
    local SeedHave = ParseNumber(Seeds)
    if SeedHave >= SeedWaitRoll then
        Roll()                -- Roll tá»‘i Ä‘a MaxRollsPerCycle láº§n
        task.spawn(RemoveUnit)
    end
    _wait(5)
end
